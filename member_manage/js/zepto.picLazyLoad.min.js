; (function ($) { $.picLazyLoad = function (settings) { var _winScrollTop = 0, _winHeight = $(window).height(); var _scrollFun = null; settings = $.extend({ seletctor: ".lazyLoad", threshold: 0, scrollArea: $(window), placeholder: 'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAoAAAAKAAgMAAABxoyGwAAAACVBMVEX////Y2Nju7u7+an5GAAACqUlEQVR42uzBgQAAAACAoP2pF6kCAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABm34xxGwSiIPqNREF6jsA9fAQXDKJ0m1uQLhfYS/iUEVYgEv5sFcmvmFdZqUZv4/FgsDHGGGOMMcYYY4wxxhhjjDHGGGOMMcYYY4wxxhhjDIhhCTb9HGyK4AoltsJGYiu8CK6wE1xhK7jCVivXwNLrU9IUWHpdi6R7UClaOrRCKYKssFndkRVeNAZaYac50Apb3QKtcNA90Ap7XQOtcJ2ru0LiZtiXTM/cDI20vWLOrrUGfxmQCjuNgVbYag60wkG3QCvsdQ+0wqJroBWugcgKnzVIVvicqweFY4DoDnEa3Gb4XmKHPbs2Cu2/8EjH/pphVYgwWPTCvClEBNQr41/4eD96ZdoDEoqwZhDR1BWDDeLTuGLwolu8n4rBDvFRp+lxYH9rtIie1hQH+u0vA6EGs4Dj9oJQg7WABTFmsiMm9XRqkFSDtYCIGqwc8QVRgxWDHaIGKwZbRA1WDA6IGqwE7BE1mB4xqQYrBhk1mAYk1WB6xKC5mhsk1WBqEDRXc4OguZoHBM3V/IhBczU3yLlqPwkImqv5EZNqMDXIuWo/MUjq6dQgqQbTgKC5mh8xqQZzg3fMXD0JqIUyV0+OWDNlrp4Z1BelBnODpGdZU4Okm8WZQXrAMUh3YjOD9IBjkB4HODGIqcHUID3gFKTnKVKDoJ4O6XGgTAGqwfxup0SZqyd3O0E1mBsE1WBqEPX7tdQgqAZzg4VTg6lBzlX7mcEomBrMDcZHYNAB0hRMA5KmoA3aIAIb/OdnWOm/gTbGmJ/24JAAAAAAQND/154wAgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwC1cxcUffDn1CAAAAAElFTkSuQmCC' }, settings || {}); lazyLoadPic(); setTimeout(function () { settings.scrollArea.scroll() }, 1000); settings.scrollArea.on('scroll', function () { clearTimeout(_scrollFun); _scrollFun = setTimeout(function () { lazyLoadPic() }, 100) }); $(document).off("wptLazyLoad:load").on("wptLazyLoad:load", function (e) { lazyLoadPic() }); function lazyLoadPic() { _winScrollTop = settings.scrollArea.scrollTop(); $(settings.seletctor + "[data-original]").each(function () { var $self = $(this); var _offsetTop = $self.offset().top; if ($self.attr('data-original')) { var dataOriginal = $self.attr('data-original'); if ((_offsetTop - settings.threshold) <= (_winHeight + _winScrollTop)) { if (settings.placeholder) { if ($self.is('img')) { if (!$self.attr("src")) { $self.attr("src", settings.placeholder) } } else { if (!$self.css("backgroundImage")) { $self.css('background-image', 'url(' + settings.placeholder + ')') } } (function (dataOriginal) { var _img = new Image(); _img.onerror = _img.onload = function () { _img.onload = null; if ($self.is('img')) { $self.attr('src', dataOriginal) } else { $self.css('background-image', 'url(' + dataOriginal + ')'); if (settings.loadingClass) { $self.removeClass(settings.loadingClass) } } $self.removeAttr('data-original') }; _img.src = dataOriginal })(dataOriginal) } else { if ($self.is('img')) { $self.attr('src', dataOriginal) } else { $self.css('background-image', 'url(' + dataOriginal + ')'); if (settings.loadingClass) { $self.removeClass(settings.loadingClass) } } $self.removeAttr('data-original') } } } }) } } })(Zepto);